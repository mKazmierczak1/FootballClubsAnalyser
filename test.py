import unidecode
import pandas as pd 

clubs = {'Bayern München': 1,
'Inter': 2,
'Bor. Mönchengladbach': 3,
'Paris Saint-Germain': 4,
'Hertha BSC': 5,
'1. FC Nürnberg ':6,
'Eintracht Braunschweig': 7,
'Atlético Madrid':8,
'1. FC Nürnberg': 9,
'Eintracht Braunschweig': 10, 
'Athletic Bilbao': 2,
'Málaga CF': 2,
'UD Almería': 2,
'AS Saint-Étienne': 2,
'Évian Thonon Gaillard': 2,
'AC Ajaccio': 2,
'Queens Park Rangers': 2,
'1. FC Köln': 2,
'Córdoba CF': 2,
'Sporting Gijón': 2,
'GFC Ajaccio': 2,
'CD Alavés': 2,
'CD Leganés': 2,
}

map_clubs = {
    'Bayern Munich': 'Bayern München',
    'Inter Milan': 'Inter',
    'PSG': 'Paris Saint-Germain',
    'Hetha': 'Hertha BSC',
    'Brunszwik': 'Eintracht Braunschweig',
    'Athletic': 'Athletic Bilbao',
    'Saint-Etienne': 'AS Saint-Étienne',
    'QPR': 'Queens Park Rangers',
    'GFC Ajaccio': 'GFC Ajaccio',
    'Parma': 'Parma Calcio 1913'
}

row = ["Club", 'p13/14', 'p13/14', 'p13/14', 'p13/14', 'p13/14', 'p13/14', 'p13/14', 'p13/14', 'p13/14', 
'b13/14', 'b13/14', 'b13/14', 'b13/14', 'b13/14', 'b13/14', 'b13/14', 'b13/14', 'b13/14',
's13/14', 's13/14', 's13/14', 's13/14', 's13/14', 's13/14', 's13/14', 's13/14', 's13/14', 
'l13/14', 'l13/14', 'l13/14', 'l13/14', 'l13/14', 'l13/14', 'l13/14', 'l13/14', 'l13/14', ]


def create_seasons_dic(year_from, year_to):
    seasons_dic = {}

    if year_from < year_to:
        for i in range(year_from, year_to):
            seasons_dic[str(year_from) + '/' + str(year_from + 1)] = '-'
    
    return seasons_dic

def extract_data_by_season(data):
    seasons = create_seasons_dic(13, 22)

    for d in data:
        seasons[d[0]] = d[1]

    return list(seasons.values())

def getSum(payrolls, balances):
    sum = []

    for i in range(0, len(payrolls)):
        if payrolls[i] != '-' and balances[i] != '-':
            sum.append(payrolls[i] + balances[i])
    
    return sum

def extract_row(data):
    row = [data[0]]
    positions = extract_data_by_season(data[1][0])
    payrolls = extract_data_by_season(data[1][1])
    balances = extract_data_by_season(data[1][2])

    row.extend(payrolls)
    row.extend(balances)
    row.extend(getSum(payrolls, balances))
    row.extend(positions)

    return row
    
def exctact_rows_from_clubs_data():
    data = []
    for k in a.keys():
        data.append(extract_row((k, a[k])))

    return data

def getClubKey(club_name: str):
    global clubs

    for key in clubs.keys():

        key_in_ASCII = unidecode.unidecode(key)
        if club_name in key_in_ASCII:
            return key
        elif club_name in map_clubs.keys():
            return map_clubs[club_name]

    return "No key found!"

# print(getClubKey('Bayern Munich'))
# print(getClubKey('Inter Milan'))
# print(getClubKey('Monchengladbach'))
# print(getClubKey("Hertha"))
# print(getClubKey('PSG'))
# print(getClubKey('Atletico'))
# print(getClubKey('1. FC Nürnberg'))


a = {'Manchester City': ([('13/14', 1), ('14/15', 2), ('15/16', 4), ('16/17', 3), ('17/18', 1), ('18/19', 1), ('19/20', 2), ('20/21', 1)], [('13/14', 133639720), ('14/15', 144309280), ('15/16', 149808080), ('16/17', 162793980), ('17/18', 178767640), ('18/19', 182629780), ('19/20', 175808200), ('20/21', 162460040)], [('13/14', -111191400), ('14/15', -61253800), ('15/16', -149600400), ('16/17', -189189400), ('17/18', -234855400), ('18/19', -33972200), ('19/20', -103887200), ('20/21', -123345400)]), 
'Liverpool FC': ([('13/14', 2), ('14/15', 6), ('15/16', 8), ('16/17', 4), ('17/18', 4), ('18/19', 2), ('19/20', 1), ('20/21', 3)], [('13/14', 77463460), ('14/15', 96795400), ('15/16', 112049260), ('16/17', 108189480), ('17/18', 112894140), ('18/19', 150402800), ('19/20', 135546600), ('20/21', 154485600)], [('13/14', -27081000), ('14/15', -55401000), ('15/16', -37004800), ('16/17', 5310000), ('17/18', 6867600), ('18/19', -152609400), ('19/20', 33134400), ('20/21', -41901800)]), 
'Chelsea FC': ([('13/14', 3), ('14/15', 1), ('15/16', 10), ('16/17', 1), ('17/18', 5), ('18/19', 3), ('19/20', 4), ('20/21', 4)], [('13/14', 121447960), ('14/15', 123479920), ('15/16', 117928020), ('16/17', 116364520), ('17/18', 143561160), ('18/19', 185858260), ('19/20', 141187000), ('20/21', 174418160)], [('13/14', -56203400), ('14/15', 7599200), ('15/16', -3197800), ('16/17', -25912800), ('17/18', -63720000), ('18/19', -164869600), ('19/20', 103816400), ('20/21', -200080800)]), 
'Arsenal FC': ([('13/14', 4), ('14/15', 3), ('15/16', 2), ('16/17', 5), ('17/18', 6), ('18/19', 5), ('19/20', 8), ('20/21', 8)], [('13/14', 84952920), ('14/15', 111718860), ('15/16', 115864200), ('16/17', 121970700), ('17/18', 186742080), ('18/19', 159724800), ('19/20', 139877200), ('20/21', 173991000)], [('13/14', -39400200), ('14/15', -96830800), ('15/16', -25488000), ('16/17', -102636400), ('17/18', 3551800), ('18/19', -79756200), ('19/20', -110282800), ('20/21', -70457800)]), 
'Everton FC': ([('13/14', 5), ('14/15', 11), ('15/16', 11), ('16/17', 7), ('17/18', 8), ('18/19', 8), ('19/20', 12), ('20/21', 10)], [('13/14', 62351200), ('14/15', 59536900), ('15/16', 65281140), ('16/17', 80047660), ('17/18', 100819200), ('18/19', 101134260), ('19/20', 103757400), ('20/21', 108646140)], [('13/14', 15186600), ('14/15', -40627400), ('15/16', -40249800), ('16/17', -26656200), ('17/18', -81479000), ('18/19', -80712000), ('19/20', -41842800), ('20/21', -74812000)]), 
'Tottenham Hotspur': ([('13/14', 6), ('14/15', 5), ('15/16', 3), ('16/17', 2), ('17/18', 3), ('18/19', 4), ('19/20', 6), ('20/21', 7)], [('13/14', 60476180), ('14/15', 77632200), ('15/16', 64012640), ('16/17', 84032520), ('17/18', 94751640), ('18/19', 107623080), ('19/20', 126944400), ('20/21', 158681680)], [('13/14', 14384200), ('14/15', -4578400), ('15/16', 17605600), ('16/17', -33240600), ('17/18', -18797400), ('18/19', 5841000), ('19/20', -97173000), ('20/21', -103226400)]), 
'Manchester United': ([('13/14', 7), ('14/15', 4), ('15/16', 5), ('16/17', 6), ('17/18', 2), ('18/19', 6), ('19/20', 3), ('20/21', 2)], [('13/14', 114804560), ('14/15', 166521600), ('15/16', 146996140), ('16/17', 185859440), ('17/18', 196081780), ('18/19', 178563500), ('19/20', 195219200), ('20/21', 228223800)], [('13/14', -80004000), ('14/15', -155122800), ('15/16', -57277200), ('16/17', -146390800), ('17/18', -162379800), ('18/19', -50279800), ('19/20', -150827600), ('20/21', -69454800)]), 
'Southampton FC': ([('13/14', 8), ('14/15', 7), ('15/16', 6), ('16/17', 8), ('17/18', 17), ('18/19', 16), ('19/20', 11), ('20/21', 15)], [('13/14', 32929080), ('14/15', 50217260), ('15/16', 50719940), ('16/17', 68760960), ('17/18', 80326140), ('18/19', 85567700), ('19/20', 63177200), ('20/21', 67477120)], [('13/14', -37594800), ('14/15', 29511800), ('15/16', -7858800), ('16/17', 17157200), ('17/18', 33028200), ('18/19', -40733600), ('19/20', -34196400), ('20/21', -11682000)]), 
'Stoke City': ([('13/14', 9), ('14/15', 9), ('15/16', 9), ('16/17', 13), ('17/18', 19)], [('13/14', 40033860), ('14/15', 43321340), ('15/16', 49746440), ('16/17', 61079160), ('17/18', 57881360)], [('13/14', -7434000), ('14/15', 2124000), ('15/16', -32343800), ('16/17', -36898600), ('17/18', -23954000)]), 'Newcastle United': ([('13/14', 10), ('14/15', 15), ('15/16', 18), ('17/18', 10), ('18/19', 13), ('19/20', 13), ('20/21', 12)], [('13/14', 43008640), ('14/15', 38624940), ('15/16', 58120900), ('17/18', 49818420), ('18/19', 58817100), ('19/20', 79425800), ('20/21', 67904280)], [('13/14', 23434800), ('14/15', -22738600), ('15/16', -109681000), ('17/18', -26443800), ('18/19', -17452200), ('19/20', -39565400), ('20/21', -41125360)]), 
'Crystal Palace': ([('13/14', 11), ('14/15', 10), ('15/16', 15), ('16/17', 14), ('17/18', 11), ('18/19', 12), ('19/20', 14), ('20/21', 14)], [('13/14', 22864860), ('14/15', 37410720), ('15/16', 63943020), ('16/17', 85218420), ('17/18', 80288380), ('18/19', 88147180), ('19/20', 87662200), ('20/21', 104707300)], [('13/14', -35046000), ('14/15', -30172600), ('15/16', -24850800), ('16/17', -54268200), ('17/18', -47530400), ('18/19', -12590600), ('19/20', 50822600), ('20/21', -2548800)]), 
'Swansea City': ([('13/14', 12), ('14/15', 8), ('15/16', 12), ('16/17', 15), ('17/18', 18)], [('13/14', 25321620), ('14/15', 35422420), ('15/16', 47922160), ('16/17', 46879040), ('17/18', 56372140)], [('13/14', -28367200), ('14/15', 21617600), ('15/16', -5841000), ('16/17', -10195200), ('17/18', 8496000)]), 
'West Ham United': ([('13/14', 13), ('14/15', 12), ('15/16', 7), ('16/17', 11), ('17/18', 13), ('18/19', 10), ('19/20', 16), ('20/21', 6)], [('13/14', 55775060), ('14/15', 53640440), ('15/16', 62932940), ('16/17', 66731360), ('17/18', 82048940), ('18/19', 97698100), ('19/20', 87917080), ('20/21', 78441680)], [('13/14', -24925140), ('14/15', -32662400), ('15/16', -36308600), ('16/17', -45135000), ('17/18', 12980000), ('18/19', -95426600), ('19/20', -60345200), ('20/21', -9239400)]), 
'Sunderland AFC': ([('13/14', 14), ('14/15', 16), ('15/16', 17), ('16/17', 20)], [('13/14', 49046700), ('14/15', 45578680), ('15/16', 54691820), ('16/17', 56359160)], [('13/14', -12248400), ('14/15', -16307600), ('15/16', -59000000), ('16/17', -19257600)]), 
'Aston Villa': ([('13/14', 15), ('14/15', 17), ('15/16', 20), ('19/20', 17), ('20/21', 11)], [('13/14', 38994280), ('14/15', 39080420), ('15/16', 43932580), ('19/20', 60357000), ('20/21', 73293340)], [('13/14', -12472600), ('14/15', -12897400), ('15/16', -1864400), ('19/20', -164716200), ('20/21', -104701400)]), 'Hull City': ([('13/14', 16), ('14/15', 18), ('16/17', 18)], [('13/14', 24808320), ('14/15', 43418100), ('16/17', 49731100)], [('13/14', -32093640), ('14/15', -31364400), ('16/17', -11788200)]), 
'West Bromwich Albion': ([('13/14', 17), ('14/15', 13), ('15/16', 14), ('16/17', 10), ('17/18', 20), ('20/21', 19)], [('13/14', 40760740), ('14/15', 41878200), ('15/16', 48994780), ('16/17', 48332800), ('17/18', 69683720), ('20/21', 43763840)], [('13/14', -4566600), ('14/15', -23977600), ('15/16', -31836400), ('16/17', -11599400), ('17/18', -54634000), ('20/21', -36686200)]), 'Norwich City': ([('13/14', 18), ('15/16', 19), ('19/20', 20)], [('13/14', 32838220), ('15/16', 38534080), ('19/20', 30904200)], [('13/14', -26786000), ('15/16', -27682800), ('19/20', -7021000)]), 
'Fulham FC': ([('13/14', 19), ('18/19', 19), ('20/21', 18)], [('13/14', 39325860), ('18/19', 60084420), ('20/21', 61559420)], [('13/14', -26915800), ('18/19', -114165000), ('20/21', -39565400)]), 'Cardiff City': ([('13/14', 20), ('18/19', 18)], [('13/14', 32888960), ('18/19', 38928200)], [('13/14', -44674800), ('18/19', -54386200)]), 
'Leicester City': ([('14/15', 14), ('15/16', 1), ('16/17', 12), ('17/18', 9), ('18/19', 9), ('19/20', 5), ('20/21', 5)], [('14/15', 39433240), ('15/16', 43516040), ('16/17', 75167180), ('17/18', 75646260), ('18/19', 94282000), ('19/20', 86765400), ('20/21', 91480680)], [('14/15', -24272600), ('15/16', -42952000), ('16/17', -27128200), ('17/18', -42421000), ('18/19', -17841600), ('19/20', -26632600), ('20/21', -4484000)]), 
'Burnley FC': ([('14/15', 19), ('16/17', 16), ('17/18', 7), ('18/19', 15), ('19/20', 10), ('20/21', 17)], [('14/15', 18385580), ('16/17', 28808520), ('17/18', 38417260), ('18/19', 52230340), ('19/20', 52474600), ('20/21', 43366180)], [('14/15', -13404800), ('16/17', -47152800), ('17/18', 15139400), ('18/19', -26550000), ('19/20', -6206800), ('20/21', -1168200)]), 
'Queens Park Rangers': ([('14/15', 20)], [('14/15', 53218000)], [('14/15', -18502400)]), 
'Watford FC': ([('15/16', 13), ('16/17', 17), ('17/18', 14), ('18/19', 11), ('19/20', 19)], [('15/16', 34242420), ('16/17', 49557640), ('17/18', 54841680), ('18/19', 58289640), ('19/20', 68050600)], [('15/16', -78352000), ('16/17', -12590600), ('17/18', -58044200), ('18/19', 22762200), ('19/20', -24426000)]), 'AFC Bournemouth': ([('15/16', 16), ('16/17', 9), ('17/18', 12), ('18/19', 14), ('19/20', 18)], [('15/16', 31214540), ('16/17', 42084700), ('17/18', 50811980), ('18/19', 62174200), ('19/20', 49973000)], [('15/16', -57837700), ('16/17', -16142400), ('17/18', -36426600), ('18/19', -69985800), ('19/20', -23316800)]), 'Middlesbrough FC': ([('16/17', 19)], [('16/17', 45864240)], [('16/17', -36591800)]), 
'Brighton & Hove Albion': ([('17/18', 15), ('18/19', 17), ('19/20', 15), ('20/21', 16)], [('17/18', 47092620), ('18/19', 50528780), ('19/20', 57489600), ('20/21', 60863220)], [('17/18', -69667200), ('18/19', -74871000), ('19/20', -79178000), ('20/21', -8389800)]), 'Huddersfield Town': ([('17/18', 16), ('18/19', 20)], [('17/18', 30216260), ('18/19', 41435700)], [('17/18', -54055800), ('18/19', -40745400)]), 
'Wolverhampton Wanderers': ([('18/19', 7), ('19/20', 7), ('20/21', 13)], [('18/19', 43880660), ('19/20', 63873400), ('20/21', 60786520)], [('18/19', -95792400), ('19/20', -99934200), ('20/21', -3823200)]), 
'Sheffield United': ([('19/20', 9), ('20/21', 20)], [('19/20', 28532400), ('20/21', 23702660)], [('19/20', -73065600), ('20/21', -66587400)]), 'Leeds United': ([('20/21', 9)], [('20/21', 28539480)], [('20/21', -113398000)])}

seasons = ['13/14', '14/15', '15/16', '16/17', '17/18', '18/19', '19/20', '20/21']

def create_tuples(name):
    l = []
    for season in seasons:
        l.append((name, season))
    
    return l

    
columns = [('', 'Club')]
columns.extend(create_tuples('Payrolls')) 
columns.extend(create_tuples('Balances'))
columns.extend(create_tuples('Sum')) 
columns.extend(create_tuples('League positions'))


# data=exctact_rows_from_clubs_data()
df = pd.DataFrame(columns=pd.MultiIndex.from_tuples(columns), data=exctact_rows_from_clubs_data())
#df.columns = 
print(df)

df.to_excel("sheet.xlsx")
